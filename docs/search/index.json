[{"content":"Exploration des séries temporelles Nous disposons des séries temporelles d\u0026rsquo;abondance (en cellules/mL) pour plusieurs groupes d\u0026rsquo;organismes de 2012 à 2021. Ces séries sont celles obtenues après un lissage par régression polynomiale locale sur les données échantillonnées en moyenne deux fois par mois.\nLa Figure 1 présente la série temporelle pour de l\u0026rsquo;abondance de Synechococcus à Banyuls.\nFigure 1: Série temporelle de l'abondance de Synechococcus à Banyuls de 2012 à 2021.\nLa série semble dirigée par des composants périodiques. Ce pourquoi on choisit de réaliser une analyse dans le domaine de fréquence. Ainsi, on étudie la série comme variation périodiques des phénomènes sous-jacents. Cette approche apporte l\u0026rsquo;avantage de pouvoir évaluer un comportement périodique commun à deux séries.\nPériodogramme Pour tout échantillon de séries temporelles \\(x_1, ...x_n\\) avec \\(n\\) impaire on peut écrire :\n[x_t=a_0 + \\sum_{j=1}^{(n-1)/2}[a_jcos(2\\pi t j/n)+b_jsin(2\\pi t j/n)]]\nLe périodogramme échelonné peut être définit de la manière suivante :\n[P(j/n)=a^2_j+b^2_j]\nLe périodogramme indique quelles composantes de fréquences ont une grande magnitude et lesquelles ont une faible magnitude. De grandes valeurs de \\(P(j/n)\\) indique donc quelles fréquences \\(w_j=j/n\\) sont prédominantes dans la série. Les petites valeurs de \\(P(j/n)\\) sont plus suceptibles d\u0026rsquo;être associées au bruit.\nLes valeurs de \\(a_j\\) et \\(b_j\\) peuvent être obtenues avec la fast Fourrier transform (FFT) :\n[|d(j/n)|^2=\\frac{1}{n}\\Big(\\sum_{t=1}^nx_tcos(2\\pi tj/n\\Big)^2+\\frac{1}{n}\\Big(\\sum_{t=1}^nx_tsin(2\\pi tj/n\\Big)^2]\nOn peut obtenir le périodogramme de la manière suivante :\n[P(j/n)=\\frac{4}{n}|d(j/n)|^2]\nLa première étape consiste à s\u0026rsquo;affranchir de la tendance présente dans notre série. En effet, les tendances vont donner de l\u0026rsquo;importance à des composantes de faible fréquence qui vont obscurcir les plus grandes fréquences. En général, on réalise un centrage des données de la forme \\(x_t-\\bar{x}\\) en amont d\u0026rsquo;une analyse spectrale.\nFigure 2: Périodogramme correspondant à l'abondance de Synechococcus à Banyuls de 2012 à 2021 avec échelle de fréquence annuelle.\nDensité spectrale La densité spectrale est analogue à une densité de probabilité. Elle donne la même information que la fonction d\u0026rsquo;autocovariance. Cependant au lieu d\u0026rsquo;exprimer la covariance en terme de lags, elle l\u0026rsquo;exprime en terme de cycle.\nSoit la fonction d\u0026rsquo;autocovariance d\u0026rsquo;un processus stationnaire \\(\\gamma(h)\\), la densité spectrale s\u0026rsquo;exprime comme la transformation inverse de l\u0026rsquo;autocovariance :\n[f(\\omega)=\\sum_{h=-\\infty}^\\infty \\gamma(h)e^{-2\\pi i\\omega h} \\quad -1/2\\leq \\omega \\leq 1/2]\nEstimation spectrale non-paramétrique La bande de fréquence \\(\\mathcal B\\) de \\(L\u0026lt;\u0026lt;n\\) fréquences fondamentales contigues centrée en \\(\\omega_j\\), s\u0026rsquo;exprime de la manière suivante :\n[\\mathcal{B}=\\Big{\\omega^:\\omega_j-\\frac{m}{n}\\leq\\omega^\\leq\\omega_j+\\frac{m}{n}\\Big}]\navec \\(L=2m+1\\) impair, choisi de manière à ce que les valeurs spectrales dans l\u0026rsquo;intervalle \\(\\mathcal B\\) :\n[f(\\omega_j+k/n), \\quad k=-m,\u0026hellip;,0,\u0026hellip;m]\nsoit approximativemment égales à \\(f(\\omega)\\). Les valeurs du spectre à l\u0026rsquo;intérieure de cette bande doivent être rlativement constante pour que le spectre lissé soit un bon estimateur.\nLe périodogramme moyen (ou lissé) et défini comme la moyenne des valeurs du périodogramme sur la bande \\(\\mathcal B\\).\n[\\bar{f}(\\omega)=\\frac{1}{L}\\sum_{k=-m}^mI(\\omega_j+k/n)]\nPour de grande valeurs de \\(n\\), les périodogrammes moyens sont distribués comme des variables aléatoires indépendantes \\(f(\\omega)\\chi_2^2/2\\) pour \\(0\u0026lt;\\omega\u0026lt;1/2\\), ainsi\n[\\frac{2L\\bar{f}(\\omega)}{f(\\omega)}\\sim \\chi_{2L}^2]\nOn parle alors de fenêtre pour faire référence à la largeur de l\u0026rsquo;intervalle de fréquence définit par \\(B=L/n\\). On peut ainsi obtenir une approximation d\u0026rsquo;un intervalle de confiance à \\(100(1-\\alpha)\\%\\) de la forme :\n[\\frac{2L\\bar{f}(\\omega)}{\\chi_{2L}^2(1-\\alpha/2)}\\leq f(\\omega) \\leq \\frac{2L\\bar{f}(\\omega)}{\\chi_{2L}^2(\\alpha/2)}]\nLa FFT est redondante lorsque \\(n\\) est un multiple de plusieurs facteurs de 2,3 ou 5. Pour profiter de cette propriété, il est commun de rajouter des 0 pour atteindre l\u0026rsquo;entier composite le plus proche \\(n'\\). Dans ce cas, il faut remplacer \\(2L\\) par \\(2L/n'\\). On définit les degrés de liberté ajustés :\n[df=\\frac{2Ln}{n\u0026rsquo;}]\net l\u0026rsquo;intervalle de confiance devient :\n[\\frac{df\\bar{f}(\\omega)}{\\chi_{df}^2(1-\\alpha/2)}\\leq f(\\omega) \\leq \\frac{df\\bar{f}(\\omega)}{\\chi_{df}^2(\\alpha/2)}]\nAprès des tests avec plusieurs valeurs de fenêtre, celle qui semble la plus compatbile avec le premier spectre (Figure 2) est celle obtenue avec \\(L=3\\) avec un noyau de Daniell (Figure 3).\nFigure 3: Périodogramme moyen correspondant à l'abondance de Synechococcus à Banyuls de 2012 à 2021 avec échelle de fréquence en cycle annuel. `\\(n=\\)` 3243 , `\\(n'=\\)` 3375 , `\\(L=\\)` 3 , `\\(df=\\)` 5.765\nIl faut noter que les fréquences qui apparaissent sur la Figure 3 correspondent à des cycles annuels. On retrouve donc bien notre cycle annuel (1/1) et notre cycle semestriel (1/2 an = 6 mois) ainsi que des pics mineurs au niveau des harmoniques. Les intrevalles de confiance associés sont présentés dans le Tableau 1. Dans les deux cas, la borne inférieure de l\u0026rsquo;intrvalle de confiance a une puissance supérieure au reste du spectre sans ces deux pics.\n\\begin{table}[h] \\caption{Interval de confiance à \\(95\\%\\) pour le spectre de l\u0026rsquo;abondance de Synechococcus à Banyuls de 2012 à 2021.} \\centering \\begin{tabular}{c c c c c} \\hline \\(\\omega\\) \u0026amp; Période \u0026amp; Puissance \u0026amp; Inférieur \u0026amp; Supérieur\\ \\hline 1/365 \u0026amp; 1 an \u0026amp; 1.2\\times 10^{8} \u0026amp; 5.1\\times 10^{7} \u0026amp; 6.3\\times 10^{8}\\ 1/180 \u0026amp; 6 mois \u0026amp; 4.8\\times 10^{7} \u0026amp; 2\\times 10^{7} \u0026amp; 2.5\\times 10^{8} \\ \\hline \\end{tabular} \\end{table}\nHarmoniques Comme c\u0026rsquo;est le cas pour le spectre de l\u0026rsquo;abondance de Synechococcus, il est commun d\u0026rsquo;observer des pics mineurs au niveau des harmoniques. Ici, on a un pic important à \\(\\omega = 1\\Delta\\) un cycle d\u0026rsquo;un an, un pic moins important à \\(\\omega=2\\Delta\\) et des pics mineurs aux autres harmoniques \\(\\omega=k\\Delta\\) pour \\(k=3,4\\) \u0026hellip; Ce cas est courant car la plupart des signaux ne sont pas des sinusoïdes parfait. Les harmoniques permettent alors de capturer le comportement non-sinyusoïdal du signal. La question est de décider si un pic est significatif ou non. On s\u0026rsquo;intéresse alors aux affirmations simultanées sur une gamme de fréquences.\nSoit \\(K\\) affirmations \\(S_1, S_2,..., S_k\\) réalisées à un niveau de confiance \\(\\alpha\\), \\(P\\{S_k\\}=1-\\alpha\\) alors la probabilité que toutes les affirmations soient vraies satisfait l\u0026rsquo;inéquation de Bonferroni :\n[P{\\text{tous }S_K \\text{ vrais}}\\geq 1-K\\alpha]\nIl est préferrable de fixer le niveau de confiance pour les tests de chaque fréquence à \\(\\alpha/K\\) s\u0026rsquo;il y a \\(K\\) potentielles fréquences d\u0026rsquo;intérêt.\nIl est possible de renforcer l\u0026rsquo;estimation en utilisant une moyenne pondérée :\n[\\hat f (\\omega) = \\sum_{k=-m}^mh_kI(\\omega_j+k/n) ]\navec les poids \\(h_k\u0026gt;0\\) qui satisfont :\n[\\sum_{k=-m}^mh_k=1]\nOn fixe \\(h_k=L^{-1}\\) pour tous \\(k\\), dans ce cas \\(\\sum_{k=-m}^mh_k^2=L^{-1}\\). On définit ainsi :\n[L_h=\\bigg(\\sum_{k=-m}^mh_k^2\\bigg)^{-1}]\net réalise l\u0026rsquo;approximation :\n[\\frac{2L_h\\hat f(\\omega)}{f(\\omega)}\\sim\\chi_{2L_h}^2]\nLa fenêtre est alors \\(B=L_h/n\\) et l\u0026rsquo;intervalle de confiance est de la forme :\n[\\frac{2L_h\\hat{f}(\\omega)}{\\chi_{2L_h}^2(1-\\alpha/2)}\\leq f(\\omega) \\leq \\frac{2L_h\\hat{f}(\\omega)}{\\chi_{2L_h}^2(\\alpha/2)}]\nOn choisis d\u0026rsquo;appliquer un noyau de Daniell modifié à \\(m=1\\) deux fois. On obtient ainsi \\(L_h=r Lh)proche de notre(L=3)` précédent.\n\\textit{Tapering} Lors de la création de fenêtre, les fenêtre sans taper peuvent produire des ondulations sur la bande voulu et à l\u0026rsquo;extérieur de la bande. Ces dernières sont appelées sidelobes. Ainsi, il est possible que certaines fréquences en dehors de l\u0026rsquo;intervalle voulu contaminent la bande. Pour supprimer cet effet de fuite, il est possible d\u0026rsquo;utiliser des taper.\nLes taper ont généralement une forme qui amplifie le centre des données par rapport aux extrémités, comme une cloche cosinus de la forme :\n[h_t=0.5\\bigg[1 + cos\\bigg(\\frac{2\\pi(t- \\bar t)}{n}\\bigg)\\bigg]]\nOn peut remplacer une série orginiale par une sérier tapered :\n[y_t = h_tx_t]\nFigure 4: Périodogramme moyen de l'abondance de Synechococcus à banyuls de 2012 à 2021 avec noyau de Daniell modifié sans taper (ligne pointillée) et avec tapering complet par une cloche cosinus (ligne pleine).\nFiltres linéaires Les filtres linéaires peuvent être utilisés pour extraire des signaux des séries temporelles.\nSi notre série filtrée \\(y_t\\) peut s\u0026rsquo;écrire de la manière suivante :\n[y_t=\\sum_{j=-\\infty}^\\infty a_jx_{t-j} \\quad \\sum_{j=-\\infty}^\\infty|a_j|\u0026lt;\\infty]\nalors \\(x_t\\) a un spectre \\(f_{xx}(\\omega)\\) et \\(y_t\\) a un spectre\n[f_{yy}(\\omega)=|A_{yx}(\\omega)|^2f_{xx}(\\omega)]\nAvec \\(A_{yx}(\\omega)\\) la fonction de fréquence de réponse :\n[A_{yx}(\\omega)=\\sum_{j=-\\infty}^\\infty a_je^{-2\\pi i\\omega j}]\nAutrement dit, l\u0026rsquo;effet du filtrage peut être caractérisé par le produit de la fréquence et de la magnitude de la fonction de fréquence réponse au carré.\nOn présente deux filtres, la première différence :\n[y_t=\\nabla x_t= x_t-x_{t-1}]\net le filtre par moyenne annuelle symétrique mobile, avec \\(t\\) exprimé en mois ou noyau de Daniell modifié avec \\(m=6\\) :\n[y_t=\\frac{1}{24}(x_{t-6}+x_{t+6}) + \\frac{1}{12}\\sum_{r=-5}^5x_{t-r}]\nComme on peut le voir sur la Figure 3, l\u0026rsquo;effet de la différenciation est de roughen la série en retenant les plus grandes fréquences, c\u0026rsquo;est un exemple de filtre high-pass. A l\u0026rsquo;inverse, l\u0026rsquo;effet de la moyenne mobile centrée est de lisser la série en gardant les basses fréquences et en atténuant les hautes fréquences. C\u0026rsquo;est un exemple de filtre low-pass.\nFigure 5: Comparaison de la série temporelle d'abondance de Synechococcus à banyuls (haut), avec la série différenciée (milieu) et la moyenne mobile centrée à 12 mois.\nPour comprendre de quelle manière les filtres affectent le signal original, on étudie le carré de la fréquence de réponse \\(|A_{yx}(\\omega)|^2\\) (Figure 4). Pour la différenciation on a :\n[A_{yx}(\\omega)=1-e^{-2\\pi i \\omega}]\nPour moyenne mobile centrée à 12 mois on a :\n[A_{yx}(\\omega)=\\frac{1}{12}\\Big[1+cos(12\\pi\\omega) + 2\\sum_{k=1}^5cos(2\\pi\\omega k)\\Big]]\nLe filtrage par différenciation va renforcer les hautes fréquences notamment à partir 3 ce qui correspond à une période de 120 jours (Figure 6). A l\u0026rsquo;inverse, le filtrage par moyenne mobile va fortement atténuer l\u0026rsquo;effet des fréquences supérieures à 0.8. Ainsi, on voit disparaître les cycles annuels et semestriels.\nDans le deux cas on a éliminé le cycle annuel. Dans le premier cas les variations à petites échelles sont mises en avant. Dans le second cas on a une mise en évidence de la tendance sur la période globale de la série.\nOn va tenter d\u0026rsquo;améliorre le flitrage du signal pour ne garder que les fréquences inférieures à 1 cycle annuel et ne pas introduire des fréquences supérieures à 1 comme le réalise légèrement le filtre par moyenne mobile.\nFigure 6: Carré de la fréquence de réponse pour les filtres par différentation (haut) et par moyenne mobile sur 12 mois (bas).\nExtraction du signal et filtrage optimal Dans le cas d\u0026rsquo;un modèle de signal avec bruit :\n[y_t=x_t+v_t]\non s\u0026rsquo;intéresse à l\u0026rsquo;estimation d\u0026rsquo;un signal \\(x_t\\) de la forme :\n[\\hat x_t=\\sum_{r=-\\infty}^\\infty a_ry_{t-r}]\nOn cherche les coefficients du filtre \\(a_t\\) qui minimisent le moyenne de l\u0026rsquo;erreur quadratique :\n[MSE=E\\bigg[\\bigg(x_t-\\sum_{r=-\\infty}^\\infty a_ry_{t-r}\\bigg)^2\\bigg]]\nCela revient à résoudre\n[\\sum_{r=-\\infty}^\\infty a_r\\gamma_{yy}(s-r)=\\gamma_{xy}(s)]\nqui équivaut à :\n[A(\\omega)f_{yy}(\\omega)=f_{xy}(\\omega)]\n\\(A(\\omega)\\) et le filtre optimal \\(a_t\\) sont des transfomrations paires de Fourrier pour \\(B(\\omega)\\) et \\(\\beta_t\\).\n[f_{xy}(\\omega)=B^*(\\omega)f_{xx}(\\omega)]\n[f_{yy}(\\omega)=|B(\\omega)|^2f_{xx}(\\omega)+f_{vv}(\\omega)]\nImpliquent que le filtre optimal serait la transformation de Fourrier de :\n[A(\\omega)=\\frac{B^*(\\omega)}{\\Big(|B(\\omega)|^2+\\frac{f_{vv}(\\omega)}{f_{xx}(\\omega)}\\Big)}]\noù le second terme du dénominateur est l\u0026rsquo;inverse du ratio signal-bruit :\n[SNR(\\omega)=\\frac{f_{xx}(\\omega)}{f_{vv}(\\omega)}]\nLes filtres optimaux peuvent donc être calculés si les spectres du signal et du bruit sont connus ou bien si on suppose connu le ratio signal-bruit. Si le ratio signal-bruit est connu, le filtre optimal peut être calculé comme la transformation inverse de la fonction \\(A(\\omega)\\). On aurait alors la fonction d\u0026rsquo;estimation du filtre :\n[a_t^M=M^{-1}\\sum_{k=0}^{M-1}A(\\omega_k)e^{2\\pi i\\omega_kt}]\nAvec \\(M\u0026lt;\u0026lt;n\\) et en pratique pour \\(|t|\u0026gt;M/2\\), \\(a_t=0\\).\nIl est possible que la forme de la fréquence réponse affiche des transitions abruptes entre des régions où le ratio signal-bruit est fort et où le signal est faible. La fréquence réponse pourrait alors présenter des ondulations qui introduieraient des fréquences à différentes amplitudes. Une solution pour palier à ce problème est d\u0026rsquo;introduir le tapering. On utilise le filtre tapered \\(\\tilde a=h_ta_t\\) où \\(h_t\\) est le taper cosinus. La fonction réponse au carré est alors \\(|\\tilde A(\\omega)|^2\\) où :\n[\\tilde A(\\omega)=\\sum_{t=-\\infty}^\\infty a_th_te^{-2\\pi i\\omega t}]\nOn garde un \\(L=3\\) comme pour les analyses précédentes. On ajuste le choix de \\(M\\) en fonction de l\u0026rsquo;allure de la fonction de fréquence réponse atteinte (Figure 7). Le \\(M\\) chosi est 1000 (jours).\nFigure 7: Coefficients du filtre avec cosinus \\textit{taper} pour l'abondance de Synechococcus à Banyuls (haut). Fonctions de fréquence réponse désirée (en bleu, pointillé) et atteinte (en rouge) pour l'abondance de Synechococcus à Banyuls avec fréquence en cycle annuel (bas). `\\(L=3\\)` et `\\(M=1000\\)`\nOn voit que le filtre accorde encore une part d\u0026rsquo;importance au cycle annuel. Néanmoins il va complètement filtrer toutes les fréquences supérieures à 1,5. Le signal filtré obtenu est illsutré en Figure 8.\nFigure 8: Série originale de l'abondance de Synechococcus à Banyuls (haut) comparée à la série filtrée (bas).\nLe problème qui se présente de manière évidente et que le choix d\u0026rsquo;un \\(M=1000\\) nous prive de 500 valeurs en début et 500 valeurs en fin de série. Néanmoins, ce filtre nous permet d\u0026rsquo;avoir une idée de la tendance générale en identifiant clairement les années et les cycles annuels.\nSéries multiples et spectres croisés Cohérence\u0026hellip;\n","date":"2022-03-01T00:00:00Z","permalink":"https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/","title":"Analyse spectrale"},{"content":"Profils verticaux de Température On dispose des profils de Température de 0 à 50m de profondeur à Banyuls de 2019 à 2021. Les observations sont réalisées environ tous les deux mois. La sonde CTD permet un relevé plus ou moins tous les 0.10-0.20m.\nPour obtenir des observations aux mêmes profondeurs, on réalise une interpolation sur les données existantes pour obtenir des valeurs tous les 0.5m de 0.5 à 50m de profondeur.\nOn propose de réaliser une ACP fonctionnelle pour les profils de température pour chaque mois. On choisi de faire un liassage avec une spline cubique avec des noeuds localisés aux observations. On fixe notre paramètre de lissage \\(\\lambda=10e-3\\).\nFigure 1: a. Cinq premières composantes principales de l'ACP fonctionnelle réalisée sur les profils de température en janvier de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 2: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en janvier, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 3: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en janvier. Les années sont représentées par un gradient de couleur.\nFigure 4: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en février de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 5: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en février, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 6: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en février. Les années sont représentées par un gradient de couleur.\nFigure 7: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en mars de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 8: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en mars, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 9: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en mars. Les années sont représentées par un gradient de couleur.\nFigure 10: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en avril de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 11: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en avril, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 12: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en avril. Les années sont représentées par un gradient de couleur.\nFigure 13: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en mai de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 14: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en mai, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 15: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en mai. Les années sont représentées par un gradient de couleur.\nFigure 16: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en juin de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 17: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en juin, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 18: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en juin. Les années sont représentées par un gradient de couleur.\nFigure 19: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en juillet de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 20: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en juillet, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 21: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en juillet. Les années sont représentées par un gradient de couleur.\nFigure 22: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en août de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 23: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en août, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 24: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en août. Les années sont représentées par un gradient de couleur.\nFigure 25: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en septembre de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 26: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en septembre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 27: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en septembre. Les années sont représentées par un gradient de couleur.\nFigure 28: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en octobre de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 29: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en octobre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 30: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en octobre. Les années sont représentées par un gradient de couleur.\nFigure 31: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en novembre de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 32: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en novembre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 33: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en novembre. Les années sont représentées par un gradient de couleur.\nFigure 34: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en décembre de 0.5 à 50m de profondeur à banyuls. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 35: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en décembre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 36: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à banyuls en décembre. Les années sont représentées par un gradient de couleur.\nFigure 37: Comparaison des scores des 2 premières composantes principales pour chaque mois.\nFigure 38: Comparaison des profils verticaux moyens de températures en noir avec intervalles de confiance à 95% associés en gris pour chaque mois.\nFigure 39: Boxplot des valeurs de températures en fonction de la profondeur par intervalle de 3m pour chaque mois. ","date":"2022-02-20T00:00:00Z","permalink":"https://ambremari.github.io/my_thesis_blog/p/banyuls/","title":"Banyuls"},{"content":"Profils verticaux de Température On dispose des profils de Température de 0 à 50m de profondeur à Marseille de 1994 à 2021. Les observations sont réalisées environ tous les deux mois. La sonde CTD permet un relevé plus ou moins tous les 0.10-0.20m.\nPour obtenir des observations aux mêmes profondeurs, on réalise une interpolation sur les données existantes pour obtenir des valeurs tous les 0.5m de 0.5 à 50m de profondeur.\nOn propose de réaliser une ACP fonctionnelle pour les profils de température pour chaque mois. On choisi de faire un liassage avec une spline cubique avec des noeuds localisés aux observations. On fixe notre paramètre de lissage \\(\\lambda=10e-3\\).\nFigure 1: a. Cinq premières composantes principales de l'ACP fonctionnelle réalisée sur les profils de température en janvier de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 2: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en janvier, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 3: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en janvier. Les années sont représentées par un gradient de couleur.\nFigure 4: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en février de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 5: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en février, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 6: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en février. Les années sont représentées par un gradient de couleur.\nFigure 7: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en mars de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 8: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en mars, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 9: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en mars. Les années sont représentées par un gradient de couleur.\nFigure 10: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en avril de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 11: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en avril, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 12: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en avril. Les années sont représentées par un gradient de couleur.\nFigure 13: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en mai de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 14: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en mai, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 15: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en mai. Les années sont représentées par un gradient de couleur.\nFigure 16: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en juin de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 17: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en juin, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 18: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en juin. Les années sont représentées par un gradient de couleur.\nFigure 19: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en juillet de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 20: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en juillet, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 21: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en juillet. Les années sont représentées par un gradient de couleur.\nFigure 22: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en août de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 23: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en août, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 24: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en août. Les années sont représentées par un gradient de couleur.\nFigure 25: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en septembre de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 26: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en septembre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 27: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en septembre. Les années sont représentées par un gradient de couleur.\nFigure 28: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en octobre de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 29: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en octobre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 30: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en octobre. Les années sont représentées par un gradient de couleur.\nFigure 31: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en novembre de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 32: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en novembre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 33: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en novembre. Les années sont représentées par un gradient de couleur.\nFigure 34: a. Cinq premières composantes principales de l'ACp fonctionnelle réalisée sur les profils de température en décembre de 0.5 à 50m de profondeur à Marseille. b. Eboulis des valeurs propres associées aux composantes principales.\nFigure 35: Deux premières composantes principales de l'ACP fonctionelle réalisée sur les profils verticaux de température en décembre, exprimées comme perturbation de la moyenne. La ligne noire représente la moyenne. La ligne grise représente l'effet d'une perturbation positive. La ligne orange représente l'effet d'une perturbation négative.\nFigure 36: Représentation bi-dimensionnelle des scores de l'ACP réalisée sur les profils de température à Marseille en décembre. Les années sont représentées par un gradient de couleur.\nFigure 37: Comparaison des scores des 2 premières composantes principales pour chaque mois.\nFigure 38: Comparaison des profils verticaux moyens de températures en noir avec intervalles de confiance à 95% associés en gris pour chaque mois.\nFigure 39: Boxplot des valeurs de températures en fonction de la profondeur par intervalle de 3m pour chaque mois. ","date":"2022-02-20T00:00:00Z","permalink":"https://ambremari.github.io/my_thesis_blog/p/marseille/","title":"Marseille"}]