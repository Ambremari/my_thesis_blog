<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Exploration des s√©ries temporelles Nous disposons des s√©ries temporelles d&amp;rsquo;abondance (en cellules/mL) pour plusieurs groupes d&amp;rsquo;organismes de 2012 √† 2021. Ces s√©ries sont celles obtenues apr√®s un lissage par r√©gression polynomiale locale sur les donn√©es √©chantillonn√©es en moyenne deux fois par mois.
La Figure 1 pr√©sente la s√©rie temporelle pour de l&amp;rsquo;abondance de Synechococcus √† Banyuls.
Figure 1: S√©rie temporelle de l&#39;abondance de Synechococcus √† Banyuls de 2012 √† 2021.'>
<title>Analyse spectrale</title>

<link rel='canonical' href='https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/'>

<link rel="stylesheet" href="/my_thesis_blog/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css"><meta property='og:title' content='Analyse spectrale'>
<meta property='og:description' content='Exploration des s√©ries temporelles Nous disposons des s√©ries temporelles d&amp;rsquo;abondance (en cellules/mL) pour plusieurs groupes d&amp;rsquo;organismes de 2012 √† 2021. Ces s√©ries sont celles obtenues apr√®s un lissage par r√©gression polynomiale locale sur les donn√©es √©chantillonn√©es en moyenne deux fois par mois.
La Figure 1 pr√©sente la s√©rie temporelle pour de l&amp;rsquo;abondance de Synechococcus √† Banyuls.
Figure 1: S√©rie temporelle de l&#39;abondance de Synechococcus √† Banyuls de 2012 √† 2021.'>
<meta property='og:url' content='https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/'>
<meta property='og:site_name' content='Mathilde Couteyen Carpaye'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Time serie' /><meta property='article:tag' content='Spectral analysis' /><meta property='article:published_time' content='2022-03-01T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-03-01T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="Analyse spectrale">
<meta name="twitter:description" content="Exploration des s√©ries temporelles Nous disposons des s√©ries temporelles d&amp;rsquo;abondance (en cellules/mL) pour plusieurs groupes d&amp;rsquo;organismes de 2012 √† 2021. Ces s√©ries sont celles obtenues apr√®s un lissage par r√©gression polynomiale locale sur les donn√©es √©chantillonn√©es en moyenne deux fois par mois.
La Figure 1 pr√©sente la s√©rie temporelle pour de l&amp;rsquo;abondance de Synechococcus √† Banyuls.
Figure 1: S√©rie temporelle de l&#39;abondance de Synechococcus √† Banyuls de 2012 √† 2021.">
    <link rel="shortcut icon" href="/favicon.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/my_thesis_blog/">
                
                    
                    
                    
                        
                        <img src="/my_thesis_blog/img/photo_profil_hu3474e4567f1abffa55ded49f8acfa40e_40711_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/my_thesis_blog">Mathilde Couteyen Carpaye</a></h1>
            <h2 class="site-description">Caract√©riser la structure et la dynamique des assemblages phytoplanctoniques du milieu c√¥tier de la s√©rie temporelle SOMLIT</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/Ambremari/2022_SOMLIT_MED'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/my_thesis_blog/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/my_thesis_blog/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/my_thesis_blog/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/my_thesis_blog/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#p√©riodogramme">P√©riodogramme</a></li>
    <li><a href="#densit√©-spectrale">Densit√© spectrale</a></li>
  </ol>

  <ol>
    <li><a href="#harmoniques">Harmoniques</a></li>
    <li><a href="#tapering">Tapering</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/my_thesis_blog/categories/notes/" >
                Notes
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/my_thesis_blog/p/analyse-spectrale/">Analyse spectrale</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 01, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    10 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="exploration-des-s√©ries-temporelles">Exploration des s√©ries temporelles</h1>
<p>Nous disposons des s√©ries temporelles d&rsquo;abondance (en cellules/mL)  pour plusieurs groupes d&rsquo;organismes de 2012 √† 2021. Ces s√©ries sont celles obtenues apr√®s un lissage par r√©gression polynomiale locale sur les donn√©es √©chantillonn√©es en moyenne deux fois par mois.</p>
<p>La Figure 1 pr√©sente la s√©rie temporelle pour de l&rsquo;abondance de Synechococcus √† Banyuls.</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-1-1.png" alt="S√©rie temporelle de l'abondance de Synechococcus √† Banyuls de 2012 √† 2021." width="672" />
<p class="caption"><span id="fig:unnamed-chunk-1"></span>Figure 1: S√©rie temporelle de l'abondance de Synechococcus √† Banyuls de 2012 √† 2021.</p>
</div>
<p>La s√©rie semble dirig√©e par des composants p√©riodiques. Ce pourquoi on choisit de r√©aliser une analyse dans le domaine de fr√©quence. Ainsi, on √©tudie  la s√©rie comme variation p√©riodiques des ph√©nom√®nes sous-jacents. Cette approche apporte l&rsquo;avantage de pouvoir √©valuer un comportement p√©riodique commun √† deux s√©ries.</p>
<h2 id="p√©riodogramme">P√©riodogramme</h2>
<p>Pour tout √©chantillon de s√©ries temporelles $(x_1, &hellip;x_n)$ avec $(n)$ impaire on peut √©crire :</p>
<p>$x_t=a_0 + \sum_{j=1}^{(n-1)/2}[a_jcos(2\pi t j/n)+b_jsin(2\pi t j/n)]$</p>
<p>Le p√©riodogramme √©chelonn√© peut √™tre d√©finit de la mani√®re suivante :</p>
<p>$P(j/n)=a^2_j+b^2_j$</p>
<p>Le p√©riodogramme indique quelles composantes de fr√©quences ont une grande magnitude et lesquelles ont une faible magnitude. De grandes valeurs de $(P(j/n))$ indique donc quelles fr√©quences $(w_j=j/n)$ sont pr√©dominantes dans la s√©rie. Les petites valeurs de $(P(j/n))$ sont plus suceptibles d&rsquo;√™tre associ√©es au bruit.</p>
<p>Les valeurs de $(a_j)$ et $(b_j)$ peuvent √™tre obtenues avec la <em>fast Fourrier transform</em> (FFT) :</p>
<p>$|d(j/n)|^2=\frac{1}{n}\Big(\sum_{t=1}^nx_tcos(2\pi tj/n\Big)^2+\frac{1}{n}\Big(\sum_{t=1}^nx_tsin(2\pi tj/n\Big)^2$</p>
<p>On peut obtenir le p√©riodogramme de la mani√®re suivante :</p>
<p>$P(j/n)=\frac{4}{n}|d(j/n)|^2$</p>
<p>La premi√®re √©tape consiste √† s&rsquo;affranchir de la tendance pr√©sente dans notre s√©rie. En effet, les tendances vont donner de l&rsquo;importance √† des composantes de faible fr√©quence qui vont obscurcir les plus grandes fr√©quences. En g√©n√©ral, on r√©alise un centrage des donn√©es de la forme $(x_t-\bar{x})$ en amont d&rsquo;une analyse spectrale.</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-2-1.png" alt="P√©riodogramme correspondant √† l'abondance de Synechococcus √† Banyuls de 2012 √† 2021 avec √©chelle de fr√©quence annuelle." width="672" />
<p class="caption"><span id="fig:unnamed-chunk-2"></span>Figure 2: P√©riodogramme correspondant √† l'abondance de Synechococcus √† Banyuls de 2012 √† 2021 avec √©chelle de fr√©quence annuelle.</p>
</div>
<h2 id="densit√©-spectrale">Densit√© spectrale</h2>
<p>La densit√© spectrale est analogue √† une densit√© de probabilit√©. Elle donne la m√™me information que la fonction d&rsquo;autocovariance. Cependant au lieu d&rsquo;exprimer la covariance en terme de lags, elle l&rsquo;exprime en terme de cycle.</p>
<p>Soit la fonction d&rsquo;autocovariance d&rsquo;un processus stationnaire $(\gamma(h))$, la densit√© spectrale s&rsquo;exprime comme la transformation inverse de l&rsquo;autocovariance :</p>
<p>$f(\omega)=\sum_{h=-\infty}^\infty \gamma(h)e^{-2\pi i\omega h} \quad -1/2\leq \omega \leq 1/2$</p>
<h1 id="estimation-spectrale-non-param√©trique">Estimation spectrale non-param√©trique</h1>
<p>La bande de fr√©quence $(\mathcal B)$ de $(L&laquo;n)$ fr√©quences fondamentales contigues centr√©e en $(\omega_j)$, s&rsquo;exprime de la mani√®re suivante :</p>
<p>$\mathcal{B}=\Big{\omega^<em>:\omega_j-\frac{m}{n}\leq\omega^</em>\leq\omega_j+\frac{m}{n}\Big}$</p>
<p>avec $(L=2m+1)$ impair, choisi de mani√®re √† ce que les valeurs spectrales dans l&rsquo;intervalle $(\mathcal B)$ :</p>
<p>$f(\omega_j+k/n), \quad k=-m,&hellip;,0,&hellip;m$</p>
<p>soit approximativemment √©gales √† $(f(\omega))$. Les valeurs du spectre √† l&rsquo;int√©rieure de cette bande doivent √™tre rlativement constante pour que le spectre liss√© soit un bon estimateur.</p>
<p>Le p√©riodogramme moyen (ou liss√©) et d√©fini comme la moyenne des valeurs du p√©riodogramme sur la bande $(\mathcal B)$.</p>
<p>$\bar{f}(\omega)=\frac{1}{L}\sum_{k=-m}^mI(\omega_j+k/n)$</p>
<p>Pour de grande valeurs de $(n)$, les p√©riodogrammes moyens sont distribu√©s comme des variables al√©atoires ind√©pendantes $(f(\omega)\chi_2^2/2)$ pour $(0&lt;\omega&lt;1/2)$, ainsi</p>
<p>$\frac{2L\bar{f}(\omega)}{f(\omega)}\sim \chi_{2L}^2$</p>
<p>On parle alors de fen√™tre pour faire r√©f√©rence √† la largeur de l&rsquo;intervalle de fr√©quence d√©finit par $(B=L/n)$. On peut ainsi obtenir une approximation d&rsquo;un intervalle de confiance √† $(100(1-\alpha)%)$ de la forme :</p>
<p>$\frac{2L\bar{f}(\omega)}{\chi_{2L}^2(1-\alpha/2)}\leq f(\omega) \leq \frac{2L\bar{f}(\omega)}{\chi_{2L}^2(\alpha/2)}$</p>
<p>La FFT est redondante lorsque $(n)$ est un multiple de plusieurs facteurs de 2,3 ou 5. Pour profiter de cette propri√©t√©, il est commun de rajouter des 0 pour atteindre l&rsquo;entier composite le plus proche $(n&rsquo;)$. Dans ce cas, il faut remplacer $(2L)$ par $(2L/n&rsquo;)$. On d√©finit les degr√©s de libert√© ajust√©s :</p>
<p>$df=\frac{2Ln}{n&rsquo;}$</p>
<p>et l&rsquo;intervalle de confiance devient :</p>
<p>$\frac{df\bar{f}(\omega)}{\chi_{df}^2(1-\alpha/2)}\leq f(\omega) \leq \frac{df\bar{f}(\omega)}{\chi_{df}^2(\alpha/2)}$</p>
<p>Apr√®s des tests avec plusieurs valeurs de fen√™tre, celle qui semble la plus compatbile avec le premier spectre (Figure 2) est celle obtenue avec $(L=3)$ avec un noyau de Daniell (Figure 3).</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-3-1.png" alt="P√©riodogramme moyen correspondant √† l'abondance de Synechococcus √† Banyuls de 2012 √† 2021 avec √©chelle de fr√©quence en cycle annuel. $\(n=\)$ 3243 , $\(n'=\)$ 3375 , $\(L=\)$ 3 , $\(df=\)$ 5.765" width="672" />
<p class="caption"><span id="fig:unnamed-chunk-3"></span>Figure 3: P√©riodogramme moyen correspondant √† l'abondance de Synechococcus √† Banyuls de 2012 √† 2021 avec √©chelle de fr√©quence en cycle annuel. $\(n=\)$ 3243 , $\(n'=\)$ 3375 , $\(L=\)$ 3 , $\(df=\)$ 5.765</p>
</div>
<p>Il faut noter que les fr√©quences qui apparaissent sur la Figure 3 correspondent √† des cycles annuels. On retrouve donc bien notre cycle annuel (1/1) et notre cycle semestriel (1/2 an = 6 mois) ainsi que des pics mineurs au niveau des harmoniques. Les intrevalles de confiance associ√©s sont pr√©sent√©s dans le Tableau 1. Dans les deux cas, la borne inf√©rieure de l&rsquo;intrvalle de confiance a une puissance sup√©rieure au reste du spectre sans ces deux pics.</p>
<p>\begin{table}[h]
\caption{Interval de confiance √† $(95%)$ pour le spectre de l&rsquo;abondance de Synechococcus √† Banyuls de 2012 √† 2021.}
\centering
\begin{tabular}{c c c c c}
\hline
$(\omega)$ &amp; P√©riode &amp; Puissance &amp; Inf√©rieur &amp; Sup√©rieur\
\hline
1/365 &amp; 1 an &amp; 1.2\times 10^{8} &amp; 5.1\times 10^{7} &amp; 6.3\times 10^{8}\
1/180 &amp; 6 mois &amp; 4.8\times 10^{7} &amp; 2\times 10^{7} &amp; 2.5\times 10^{8} \
\hline
\end{tabular}
\end{table}</p>
<h2 id="harmoniques">Harmoniques</h2>
<p>Comme c&rsquo;est le cas pour le spectre de l&rsquo;abondance de Synechococcus, il est commun d&rsquo;observer des pics mineurs au niveau des harmoniques. Ici, on a un pic important √† $(\omega = 1\Delta)$ un cycle d&rsquo;un an, un pic moins important √† $(\omega=2\Delta)$ et des pics mineurs aux autres harmoniques $(\omega=k\Delta)$ pour $(k=3,4)$ &hellip; Ce cas est courant car la plupart des signaux ne sont pas des sinuso√Ødes parfait. Les harmoniques permettent alors de capturer le comportement non-sinyuso√Ødal du signal. La question est de d√©cider si un pic est significatif ou non. On s&rsquo;int√©resse alors aux affirmations simultan√©es sur une gamme de fr√©quences.</p>
<p>Soit $(K)$ affirmations $(S_1, S_2,&hellip;, S_k)$ r√©alis√©es √† un niveau de confiance $(\alpha)$, $(P{S_k}=1-\alpha)$ alors la probabilit√© que toutes les affirmations soient vraies satisfait l&rsquo;in√©quation de Bonferroni :</p>
<p>$P{\text{tous }S_K \text{ vrais}}\geq 1-K\alpha$</p>
<p>Il est pr√©ferrable de fixer le niveau de confiance pour les tests de chaque fr√©quence √† $(\alpha/K)$ s&rsquo;il y a $(K)$ potentielles fr√©quences d&rsquo;int√©r√™t.</p>
<p>Il est possible de renforcer l&rsquo;estimation en utilisant une moyenne pond√©r√©e :</p>
<p>$\hat f (\omega) = \sum_{k=-m}^mh_kI(\omega_j+k/n) $</p>
<p>avec les poids $(h_k&gt;0)$ qui satisfont :</p>
<p>$\sum_{k=-m}^mh_k=1$</p>
<p>On fixe $(h_k=L^{-1})$ pour tous $(k)$, dans ce cas $(\sum_{k=-m}^mh_k^2=L^{-1})$. On d√©finit ainsi :</p>
<p>$L_h=\bigg(\sum_{k=-m}^mh_k^2\bigg)^{-1}$</p>
<p>et r√©alise l&rsquo;approximation :</p>
<p>$\frac{2L_h\hat f(\omega)}{f(\omega)}\sim\chi_{2L_h}^2$</p>
<p>La fen√™tre est alors $(B=L_h/n)$ et l&rsquo;intervalle de confiance est de la forme :</p>
<p>$\frac{2L_h\hat{f}(\omega)}{\chi_{2L_h}^2(1-\alpha/2)}\leq f(\omega) \leq \frac{2L_h\hat{f}(\omega)}{\chi_{2L_h}^2(\alpha/2)}$</p>
<p>On choisis d&rsquo;appliquer un noyau de Daniell modifi√© √† $(m=1)$ deux fois. On obtient ainsi $(L_h=$r Lh)$ proche de notre $(L=3)$ pr√©c√©dent.</p>
<h2 id="tapering">Tapering</h2>
<p>Lors de la cr√©ation de fen√™tre, les fen√™tre sans <em>taper</em> peuvent produire des ondulations sur la bande voulu et √† l&rsquo;ext√©rieur de la bande. Ces derni√®res sont appel√©es <em>sidelobes</em>. Ainsi, il est possible que certaines fr√©quences en dehors de l&rsquo;intervalle voulu contaminent la bande. Pour supprimer cet effet de fuite, il est possible d&rsquo;utiliser des <em>taper</em>.</p>
<p>Les <em>taper</em> ont g√©n√©ralement une forme qui amplifie le centre des donn√©es par rapport aux extr√©mit√©s, comme une cloche cosinus de la forme :</p>
<p>$h_t=0.5\bigg[1 + cos\bigg(\frac{2\pi(t- \bar t)}{n}\bigg)\bigg]$</p>
<p>On peut remplacer une s√©rie orginiale par une s√©rier <em>tapered</em> :</p>
<p>$y_t = h_tx_t$</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-6-1.png" alt="P√©riodogramme moyen de l'abondance de Synechococcus √† banyuls de 2012 √† 2021 avec noyau de Daniell modifi√© sans taper (ligne pointill√©e) et avec tapering complet par une cloche cosinus (ligne pleine)." width="672" />
<p class="caption"><span id="fig:unnamed-chunk-6"></span>Figure 4: P√©riodogramme moyen de l'abondance de Synechococcus √† banyuls de 2012 √† 2021 avec noyau de Daniell modifi√© sans taper (ligne pointill√©e) et avec tapering complet par une cloche cosinus (ligne pleine).</p>
</div>
<h1 id="filtres-lin√©aires">Filtres lin√©aires</h1>
<p>Les filtres lin√©aires peuvent √™tre utilis√©s pour extraire des signaux des s√©ries temporelles.</p>
<p>Si notre s√©rie filtr√©e $(y_t)$ peut s&rsquo;√©crire de la mani√®re suivante :</p>
<p>$y_t=\sum_{j=-\infty}^\infty a_jx_{t-j} \quad \sum_{j=-\infty}^\infty|a_j|&lt;\infty$</p>
<p>alors $(x_t)$ a un spectre $(f_{xx}(\omega))$ et $(y_t)$ a un spectre</p>
<p>$f_{yy}(\omega)=|A_{yx}(\omega)|^2f_{xx}(\omega)$</p>
<p>Avec $(A_{yx}(\omega))$ la fonction de fr√©quence de r√©ponse :</p>
<p>$A_{yx}(\omega)=\sum_{j=-\infty}^\infty a_je^{-2\pi i\omega j}$</p>
<p>Autrement dit, l&rsquo;effet du filtrage peut √™tre caract√©ris√© par le produit de la fr√©quence et de la magnitude de la fonction de fr√©quence r√©ponse au carr√©.</p>
<p>On pr√©sente deux filtres, la premi√®re diff√©rence :</p>
<p>$y_t=\nabla x_t= x_t-x_{t-1}$</p>
<p>et le filtre par moyenne annuelle sym√©trique mobile, avec $(t)$ exprim√© en mois ou noyau de Daniell modifi√© avec $(m=6)$ :</p>
<p>$y_t=\frac{1}{24}(x_{t-6}+x_{t+6}) + \frac{1}{12}\sum_{r=-5}^5x_{t-r}$</p>
<p>Comme on peut le voir sur la Figure 3, l&rsquo;effet de la diff√©renciation est de <em>roughen</em> la s√©rie en retenant les plus grandes fr√©quences, c&rsquo;est un exemple de filtre <em>high-pass</em>. A l&rsquo;inverse, l&rsquo;effet de la moyenne mobile centr√©e est de lisser la s√©rie en gardant les basses fr√©quences et en att√©nuant les hautes fr√©quences. C&rsquo;est un exemple de filtre <em>low-pass</em>.</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-7-1.png" alt="Comparaison de la s√©rie temporelle d'abondance de Synechococcus √† banyuls (haut), avec la s√©rie diff√©renci√©e (milieu) et la moyenne mobile centr√©e √† 12 mois." width="672" />
<p class="caption"><span id="fig:unnamed-chunk-7"></span>Figure 5: Comparaison de la s√©rie temporelle d'abondance de Synechococcus √† banyuls (haut), avec la s√©rie diff√©renci√©e (milieu) et la moyenne mobile centr√©e √† 12 mois.</p>
</div>
<p>Pour comprendre de quelle mani√®re les filtres affectent le signal original, on √©tudie le carr√© de la fr√©quence de r√©ponse $(|A_{yx}(\omega)|^2)$ (Figure 4). Pour la diff√©renciation on a :</p>
<p>$A_{yx}(\omega)=1-e^{-2\pi i \omega}$</p>
<p>Pour moyenne mobile centr√©e √† 12 mois on a :</p>
<p>$A_{yx}(\omega)=\frac{1}{12}\Big[1+cos(12\pi\omega) + 2\sum_{k=1}^5cos(2\pi\omega k)\Big]$</p>
<p>Le filtrage par diff√©renciation va renforcer les hautes fr√©quences notamment √† partir 3 ce qui correspond √† une p√©riode de 120 jours (Figure 6). A l&rsquo;inverse, le filtrage par moyenne mobile va fortement att√©nuer l&rsquo;effet des fr√©quences sup√©rieures √† 0.8. Ainsi, on voit dispara√Ætre les cycles annuels et semestriels.</p>
<p>Dans le deux cas on a √©limin√© le cycle annuel. Dans le premier cas les variations √† petites √©chelles sont mises en avant. Dans le second cas on a une mise en √©vidence de la tendance sur la p√©riode globale de la s√©rie.</p>
<p>On va tenter d&rsquo;am√©liorre le flitrage du signal pour ne garder que les fr√©quences inf√©rieures √† 1 cycle annuel et ne pas introduire des fr√©quences sup√©rieures √† 1 comme le r√©alise l√©g√®rement le filtre par moyenne mobile.</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-8-1.png" alt="Carr√© de la fr√©quence de r√©ponse pour les filtres par diff√©rentation (haut) et par moyenne mobile sur 12 mois (bas)." width="672" />
<p class="caption"><span id="fig:unnamed-chunk-8"></span>Figure 6: Carr√© de la fr√©quence de r√©ponse pour les filtres par diff√©rentation (haut) et par moyenne mobile sur 12 mois (bas).</p>
</div>
<h1 id="extraction-du-signal-et-filtrage-optimal">Extraction du signal et filtrage optimal</h1>
<p>Dans le cas d&rsquo;un mod√®le de signal avec bruit :</p>
<p>$y_t=x_t+v_t$</p>
<p>on s&rsquo;int√©resse √† l&rsquo;estimation d&rsquo;un signal $(x_t)$ de la forme :</p>
<p>$\hat x_t=\sum_{r=-\infty}^\infty a_ry_{t-r}$</p>
<p>On cherche les coefficients du filtre $(a_t)$ qui minimisent le moyenne de l&rsquo;erreur quadratique :</p>
<p>$MSE=E\bigg[\bigg(x_t-\sum_{r=-\infty}^\infty a_ry_{t-r}\bigg)^2\bigg]$</p>
<p>Cela revient √† r√©soudre</p>
<p>$\sum_{r=-\infty}^\infty a_r\gamma_{yy}(s-r)=\gamma_{xy}(s)$</p>
<p>qui √©quivaut √† :</p>
<p>$A(\omega)f_{yy}(\omega)=f_{xy}(\omega)$</p>
<p>$(A(\omega))$ et le filtre optimal $(a_t)$ sont des transfomrations paires de Fourrier pour $(B(\omega))$ et $(\beta_t)$.</p>
<p>$f_{xy}(\omega)=B^*(\omega)f_{xx}(\omega)$</p>
<p>$f_{yy}(\omega)=|B(\omega)|^2f_{xx}(\omega)+f_{vv}(\omega)$</p>
<p>Impliquent que le filtre optimal serait la transformation de Fourrier de :</p>
<p>$A(\omega)=\frac{B^*(\omega)}{\Big(|B(\omega)|^2+\frac{f_{vv}(\omega)}{f_{xx}(\omega)}\Big)}$</p>
<p>o√π le second terme du d√©nominateur est l&rsquo;inverse du ratio signal-bruit :</p>
<p>$SNR(\omega)=\frac{f_{xx}(\omega)}{f_{vv}(\omega)}$</p>
<p>Les filtres optimaux peuvent donc √™tre calcul√©s si les spectres du signal et du bruit sont connus ou bien si on suppose connu le ratio signal-bruit. Si le ratio signal-bruit est connu, le filtre optimal peut √™tre calcul√© comme la transformation inverse de la fonction $(A(\omega))$. On aurait alors la fonction d&rsquo;estimation du filtre :</p>
<p>$a_t^M=M^{-1}\sum_{k=0}^{M-1}A(\omega_k)e^{2\pi i\omega_kt}$</p>
<p>Avec $(M&laquo;n)$ et en pratique pour $(|t|&gt;M/2)$, $(a_t=0)$.</p>
<p>Il est possible que la forme de la fr√©quence r√©ponse affiche des transitions abruptes entre des r√©gions o√π le ratio signal-bruit est fort et o√π le signal est faible. La fr√©quence r√©ponse pourrait alors pr√©senter des ondulations qui introduieraient des fr√©quences √† diff√©rentes amplitudes. Une solution pour palier √† ce probl√®me est d&rsquo;introduir le <em>tapering</em>. On utilise le filtre <em>tapered</em> $(\tilde a=h_ta_t)$ o√π $(h_t)$ est le <em>taper</em> cosinus. La fonction r√©ponse au carr√© est alors $(|\tilde A(\omega)|^2)$ o√π :</p>
<p>$\tilde A(\omega)=\sum_{t=-\infty}^\infty a_th_te^{-2\pi i\omega t}$</p>
<p>On garde un $(L=3)$ comme pour les analyses pr√©c√©dentes. On ajuste le choix de $(M)$ en fonction de l&rsquo;allure de la fonction de fr√©quence r√©ponse atteinte (Figure 7). Le $(M)$ chosi est 1000 (jours).</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-9-1.png" alt="Coefficients du filtre avec cosinus taper pour l'abondance de Synechococcus √† Banyuls (haut). Fonctions de fr√©quence r√©ponse d√©sir√©e (en bleu, pointill√©) et atteinte (en rouge) pour l'abondance de Synechococcus √† Banyuls avec fr√©quence en cycle annuel (bas). $\(L=3\)$ et $\(M=1000\)$" width="672" />
<p class="caption"><span id="fig:unnamed-chunk-9"></span>Figure 7: Coefficients du filtre avec cosinus taper pour l'abondance de Synechococcus √† Banyuls (haut). Fonctions de fr√©quence r√©ponse d√©sir√©e (en bleu, pointill√©) et atteinte (en rouge) pour l'abondance de Synechococcus √† Banyuls avec fr√©quence en cycle annuel (bas). $\(L=3\)$ et $\(M=1000\)$</p>
</div>
<p>On voit que le filtre accorde encore une part d&rsquo;importance au cycle annuel. N√©anmoins il va compl√®tement filtrer toutes les fr√©quences sup√©rieures √† 1,5. Le signal filtr√© obtenu est illsutr√© en Figure 8.</p>
<div class="figure">
<img src="https://ambremari.github.io/my_thesis_blog/p/analyse-spectrale/index_files/figure-html/unnamed-chunk-10-1.png" alt="S√©rie originale de l'abondance de Synechococcus √† Banyuls (haut) compar√©e √† la s√©rie filtr√©e (bas)." width="672" />
<p class="caption"><span id="fig:unnamed-chunk-10"></span>Figure 8: S√©rie originale de l'abondance de Synechococcus √† Banyuls (haut) compar√©e √† la s√©rie filtr√©e (bas).</p>
</div>
<p>Le probl√®me qui se pr√©sente de mani√®re √©vidente et que le choix d&rsquo;un $(M=1000)$ nous prive de 500 valeurs en d√©but et 500 valeurs en fin de s√©rie. N√©anmoins, ce filtre nous permet d&rsquo;avoir une id√©e de la tendance g√©n√©rale en identifiant clairement les ann√©es et les cycles annuels.</p>
<h1 id="s√©ries-multiples-et-spectres-crois√©s">S√©ries multiples et spectres crois√©s</h1>
<p>Coh√©rence&hellip;</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/my_thesis_blog/tags/time-serie/">Time serie</a>
        
            <a href="/my_thesis_blog/tags/spectral-analysis/">Spectral analysis</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "suivi-these-couteyen" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 Mathilde Couteyen Carpaye
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.21.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/my_thesis_blog/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
